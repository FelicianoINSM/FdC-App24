#:kivy 2.3.0

TabManager:
    Home:
    Menu:
    Programar:
    Historico:
    Configuracion:

<TextLabel@Label>:
    color: 1, 1, 1, 1

<Button>:
    color: 1, 1, 1, 1
    bold: True

<Home>:
    name: "home"

    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'top'
        padding: 30

        canvas.before:
            Color:
                rgba: 0.21, 0.21, 0.21, 1  
            Rectangle:
                pos: self.pos
                size: self.size
    
        GridLayout:
            cols: 1
            size_hint: (1, 0.2)
            row_default_height: '50dp'
            row_force_default: True

            TextLabel:
                text: "Sistema de Riego"
                font_size: 68
                bold: True
            TextLabel:
                text: "INSM 2024"
                font_size: 40
            

    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'center'



        BoxLayout:
            orientation: 'vertical'
            spacing: '30dp'
            size_hint: 0.5, 0.6

            TextLabel:
                text: "ASPERSORES"
                font_size: 55
                bold: True
            Switch:
                id: aspersores

            TextLabel:
                text: "Temperatura"
                font_size: 40
                bold: True
            TextLabel:
                id: temp
                text: "34°"
                font_size: 44
            TextLabel:
                text: "Humedad ambiente"
                font_size: 40
                bold: True
            TextLabel:
                id: env_humidity
                text: "45%"
                font_size: 44
            TextLabel:
                text: "Humedad del suelo"
                font_size: 40
                bold: True
            TextLabel:
                id: humidity
                text: "97%"
                font_size: 44
            TextLabel:
                text: "Ultimo riego"
                font_size: 40
                bold: True
            TextLabel:
                id: last_time
                text: "22:30"
                font_size: 44
                                   
    AnchorLayout:
        anchor_x: 'right'
        anchor_y: 'bottom'
        padding: '30dp'

        Button:
            size_hint: 0.2, 0.1
            background_color: 0.21, 0.21, 0.21, 0
            always_release: True

            on_press:
                burger_image.source = 'images/menu_pressed.png'

            on_release:
                burger_image.source = 'images/menu.png'
                app.root.current = "menu"
                root.manager.transition.direction = "left"

            Image:
                id: burger_image
                source: 'images/menu.png'
                center_x: self.parent.center_x
                center_y: self.parent.center_y
   

<Menu>:
    name: "menu"
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'center'
        
        canvas.before:
            Color:
                rgba: 0.21, 0.21, 0.21, 1  
            Rectangle:
                pos: self.pos
                size: self.size

        GridLayout:
            size_hint: 0.75, 0.3
            cols: 1
            spacing: '20dp'

            Button:
                text: "Programar\nHORARIO de riego"
                text_size: self.width - dp(30), None
                font_size: '24dp'
                on_release: root.go_to_programar()
            Button:
                text: "Ver\nHISTORICO"
                text_size: self.width - dp(30), None
                font_size: '24dp'
                on_release: root.go_to_historico()
            Button:
                text: "Configuración\nde la APP"
                text_size: self.width - dp(30), None
                font_size: '24dp'
                on_release: root.go_to_configuracion()
                

    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'bottom'
        padding: '30dp'

        Button:
            size_hint: 0.2, 0.1
            background_color: 0.21, 0.21, 0.21, 0
            always_release: True

            on_press:
                return_image.source = 'images/return_pressed.png'

            on_release:
                return_image.source = 'images/return.png'
                app.root.current = "home"
                root.manager.transition.direction = "right"

            Image:
                id: return_image
                source: 'images/return.png'
                center_x: self.parent.center_x
                center_y: self.parent.center_y    

<Programar>:
    start_hour_spinner: start_hour_spinner
    start_minute_spinner: start_minute_spinner
    end_hour_spinner: end_hour_spinner
    end_minute_spinner: end_minute_spinner
    day_checkboxes: day_checkboxes

    BoxLayout:
        orientation: 'vertical'
        padding: '10dp'
        spacing: '10dp'
        canvas.before:
            Color:
                rgba: 0.73, 0.6, 0.95, 1  # Color de fondo general
            Rectangle:
                pos: self.pos
                size: self.size

        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'top'
            size_hint_y: None
            height: '60dp'

            canvas.before:
                Color:
                    rgba: 0.5, 0.3, 0.6, 1  # Color púrpura oscuro para el título
                Rectangle:
                    pos: self.pos
                    size: self.size
            Label:
                text: "Configurar Riego"
                color: 1, 1, 1, 1
                bold: True
                font_size: '20sp'

        Label:
            text: 'Hora de Inicio'
            size_hint_y: None
            height: '30dp'
            color: 0.5, 0.1, 0.5, 1
            bold: True
            font_size: '18sp'

        BoxLayout:
            orientation: 'horizontal'
            spacing: '10dp'
            size_hint_y: None
            height: '40dp'
            Spinner:
                id: start_hour_spinner
                text: '00'
                values: [str(i).zfill(2) for i in range(24)]
                background_color: 0.8, 0.7, 1, 1
            Spinner:
                id: start_minute_spinner
                text: '00'
                values: [str(i).zfill(2) for i in range(0, 60, 5)]
                background_color: 0.8, 0.7, 1, 1

        Label:
            text: 'Hora de Fin'
            size_hint_y: None
            height: '30dp'
            color: 0.5, 0.1, 0.5, 1
            bold: True
            font_size: '18sp'

        BoxLayout:
            orientation: 'horizontal'
            spacing: '10dp'
            size_hint_y: None
            height: '40dp'
            Spinner:
                id: end_hour_spinner
                text: '00'
                values: [str(i).zfill(2) for i in range(24)]
                background_color: 0.8, 0.7, 1, 1
            Spinner:
                id: end_minute_spinner
                text: '00'
                values: [str(i).zfill(2) for i in range(0, 60, 5)]
                background_color: 0.8, 0.7, 1, 1

        Label:
            text: 'Seleccione días de la semana'
            size_hint_y: None
            height: '30dp'
            color: 0.5, 0.1, 0.5, 1
            bold: True
            font_size: '18sp'

        GridLayout:
            id: day_checkboxes
            cols: 4
            spacing: '10dp'
            size_hint_y: None
            height: '80dp'

            BoxLayout:
                orientation: 'horizontal'
                size_hint_x: None
                width: '120dp'
                Label:
                    text: 'Lunes'
                    size_hint_x: None
                    width: '60dp'
                CheckBox:
                    id: day_monday
                    color: 0.2, 0.2, 0.2, 1
                    background_color: 0.2, 0.2, 0.2, 1
            BoxLayout:
                orientation: 'horizontal'
                size_hint_x: None
                width: '120dp'
                Label:
                    text: 'Martes'
                    size_hint_x: None
                    width: '60dp'
                CheckBox:
                    id: day_tuesday
                    color: 0.2, 0.2, 0.2, 1
                    background_color: 0.2, 0.2, 0.2, 1
            BoxLayout:
                orientation: 'horizontal'
                size_hint_x: None
                width: '120dp'
                Label:
                    text: 'Miércoles'
                    size_hint_x: None
                    width: '60dp'
                CheckBox:
                    id: day_wednesday
                    color: 0.2, 0.2, 0.2, 1
                    background_color: 0.2, 0.2, 0.2, 1
            BoxLayout:
                orientation: 'horizontal'
                size_hint_x: None
                width: '120dp'
                Label:
                    text: 'Jueves'
                    size_hint_x: None
                    width: '60dp'
                CheckBox:
                    id: day_thursday
                    color: 0.2, 0.2, 0.2, 1
                    background_color: 0.2, 0.2, 0.2, 1
            BoxLayout:
                orientation: 'horizontal'
                size_hint_x: None
                width: '120dp'
                Label:
                    text: 'Viernes'
                    size_hint_x: None
                    width: '60dp'
                CheckBox:
                    id: day_friday
                    color: 0.2, 0.2, 0.2, 1
                    background_color: 0.2, 0.2, 0.2, 1
            BoxLayout:
                orientation: 'horizontal'
                size_hint_x: None
                width: '120dp'
                Label:
                    text: 'Sábado'
                    size_hint_x: None
                    width: '60dp'
                CheckBox:
                    id: day_saturday
                    color: 0.2, 0.2, 0.2, 1
                    background_color: 0.2, 0.2, 0.2, 1
            BoxLayout:
                orientation: 'horizontal'
                size_hint_x: None
                width: '120dp'
                Label:
                    text: 'Domingo'
                    size_hint_x: None
                    width: '60dp'
                CheckBox:
                    id: day_sunday
                    color: 0.2, 0.2, 0.2, 1
                    background_color: 0.2, 0.2, 0.2, 1

        BoxLayout:
            orientation: 'horizontal'
            spacing: '20dp'
            size_hint_y: None
            height: '50dp'
            padding: '10dp'

            Button:
                text: 'Guardar'
                size_hint: (0.5, 1)
                background_color: 0.5, 0.3, 0.6, 1
                color: 1, 1, 1, 1
                on_release: root.save_schedule()

            Button:
                text: "Volver"
                size_hint: (0.5, 1)
                background_color: 0.5, 0.3, 0.6, 1
                color: 1, 1, 1, 1
                on_release: root.manager.current = "menu"


<Historico>:
    name: "historico"
    Label:
        text: "Pantalla de Historial"
        font_size: 30

<Configuracion>:
    name: "configuracion"
    Label:
        text: "Pantalla de Configuración"
        font_size: 30



